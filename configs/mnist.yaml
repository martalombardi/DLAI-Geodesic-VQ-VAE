dataset:
  name: mnist
  channels: 1
  image_size: 28

vae:
  latent_dim: 64
  base_channels: 32
  lr: 1.0e-3
  batch_size: 128
  epochs: 30
  beta_kl: 1.0
  loss_reduction: sum

geodesy:
  metric: riemannian   # or euclidean
  n_landmarks: 10000
  knn_k: 15
  kmedoids_seed: 42
  batch_edges: 64

codebook:
  n_landmarks: 10000
  knn_k: 15
  metric: riemannian        # riemannian | euclidean
  symmetrize: true
  batch_edges: 64
  n_codes: 128
  kmedoids_seed: 42
  inf_fill_factor: 2.0
  eps_weight: 1.0e-5

transformer:
  n_codes: 128
  start_token: 128
  grid_res: 7
  d_model: 256
  n_heads: 8
  n_layers: 4
  dropout: 0.0
  batch_size: 64
  epochs: 30
  lr: 5.0e-4
  weight_decay: 0.00
  grad_clip: 1.0

quantize:
  batch_size: 256

generate:
  n_samples: 16
  seed: 42
