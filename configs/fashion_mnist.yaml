dataset:
  name: fashion_mnist
  channels: 1
  image_size: 28

vae:
  latent_dim: 32
  base_channels: 48        # più capacità (32→48)
  lr: 1.0e-3
  batch_size: 128
  epochs: 40               # un filo di training in più
  beta_kl: 0.5
  loss_reduction: sum

geodesy:
  metric: riemannian
  n_landmarks: 8000        # più landmarks aiuta la geodesia su FashionMNIST
  knn_k: 10                # 10→15
  kmedoids_seed: 42
  batch_edges: 64

codebook:
  n_landmarks: 8000
  knn_k: 10
  metric: riemannian
  symmetrize: true
  batch_edges: 64
  n_codes: 64
  kmedoids_seed: 42
  inf_fill_factor: 2.0
  eps_weight: 1.0e-5

transformer:
  n_codes: 64
  start_token: 64
  grid_res: 7
  d_model: 256
  n_heads: 8
  n_layers: 4
  dropout: 0.2            # 0.0→0.1 per stabilità
  batch_size: 64
  epochs: 40              # un filo di training in più
  lr: 5.0e-4
  weight_decay: 0.01
  grad_clip: 1.0

quantize:
  batch_size: 256

generate:
  n_samples: 16

  seed: 123

