dataset:
  name: fashion_mnist
  channels: 1
  image_size: 28

vae:
  latent_dim: 32
  base_channels: 48
  lr: 1.0e-3
  batch_size: 128
  epochs: 40
  beta_kl: 0.5
  loss_reduction: sum

vq_vae:
  latent_dim: 64
  base_channels: 48
  lr: 1.0e-3
  batch_size: 128
  epochs: 30
  beta_commit: 1.0
  vq_weight: 1.0
  loss_reduction: sum

geodesy:
  metric: riemannian
  n_landmarks: 8000
  knn_k: 10
  kmedoids_seed: 42
  batch_edges: 64

codebook:
  n_landmarks: 8000
  knn_k: 10
  metric: riemannian
  symmetrize: true
  batch_edges: 64
  n_codes: 64
  kmedoids_seed: 42
  inf_fill_factor: 2.0
  eps_weight: 1.0e-5

transformer:
  n_codes: 64
  start_token: 64
  grid_res: 7
  d_model: 256
  n_heads: 8
  n_layers: 4
  dropout: 0.2
  batch_size: 64
  epochs: 10
  lr: 5.0e-4
  weight_decay: 0.01
  grad_clip: 1.0

quantize:
  batch_size: 256

generate:
  n_samples: 16
  seed: 123